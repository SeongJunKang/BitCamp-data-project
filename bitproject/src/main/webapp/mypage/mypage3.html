<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">

    <title>산책할개</title>

   <!-- Bootstrap Core CSS -->
    <link href="../bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link href="../bower_components/css/agency.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    
	  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
		<script src="http://code.jquery.com/jquery-latest.min.js"></script>
		<script src="//code.jquery.com/jquery-1.10.2.js"></script>
		<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script> 
    <!-- Bootstrap Core JavaScript -->
    <script src="../bower_components/bootstrap/dist/js/bootstrap.js"></script>

    <!-- Plugin JavaScript -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="../bower_components/js/classie.js"></script>
    <script src="../bower_components/js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="../bower_components/js/jqBootstrapValidation.js"></script>
    <script src="../bower_components/js/contact_me.js"></script>
    <!-- Custom Theme JavaScript -->
    <script src="../bower_components/js/agency.js"></script>
    <!-- check login -->
    <script type="text/javascript" src="../LoginCheck.js"></script>
    <!-- Daum map API -->
    <script src="http://apis.daum.net/maps/maps3.js?apikey=7ae134637aef8f4bb01892e30a801547&libraries=services"></script>
<style>
#logout {
  margin-right: 5px;
}
#container1 {
  padding-top: 140px;
  padding-bottom: 110px;
  margin-left: auto;
  margin-right: auto;
  width: 1100px;
}

#change-acc {
  text-align: right;
}

#change-acc-btn {
  margin-bottom: -40px;
  
}
#deletediv {
  text-align: right;
}
#delete {
  margin-bottom: -50px;
}
#change-acc-btn:hover {
  transition-property: background-color, color;
  transition-duration: 0.01s;
  transition-timing-function: ease-out;
  background-color:#5bc0de;
  color:white;
}

#save {
  text-align: right;
}
#savebtn {
  width: 100px;
}
.table {
  text-align: left;
}
.input-group1 {
  display: inline-block;
  width: 100px;
}

.input-group2 {
  display: inline-block;
  width: 300px;
}

.table-responsive {
  margin-left: auto;
  margin-right: auto;
  width: 1100px;
}

#changeAc {
  float: right;
}

hr {
  border: 1px solid lightgray;
}

.dropdown {
  display: inline;
}

.form-control {
  display: inline-block;
}

.btn-me {
  color: #ffffff;
  background-color: #fed136;
  border-color: #fed136;
  font-family: "Montserrat", "Helvetica Neue", Helvetica, Arial, sans-serif;
  text-transform: uppercase;
  display: inline-block;
  padding: 6px 12px;
  margin-bottom: 0;
  font-size: 14px;
  font-weight: normal;
  line-height: 1.42857143;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 4px;
}
.btn-me:hover,
.btn-me:focus,
.btn-me:active,
.btn-me.active,
.open .dropdown-toggle.btn-me {
  color: #ffffff;
  background-color: #fec503;
  border-color: #f6bf01;
}
.btn-me:active,
.btn-me.active,
.open .dropdown-toggle.btn-me {
  background-image: none;
}
.btn-me.disabled,
.btn-me[disabled],
fieldset[disabled] .btn-me,
.btn-me.disabled:hover,
.btn-me[disabled]:hover,
fieldset[disabled] .btn-me:hover,
.btn-me.disabled:focus,
.btn-me[disabled]:focus,
fieldset[disabled] .btn-me:focus,
.btn-me.disabled:active,
.btn-me[disabled]:active,
fieldset[disabled] .btn-me:active,
.btn-me.disabled.active,
.btn-me[disabled].active,
fieldset[disabled] .btn-me.active {
  background-color: #fed136;
  border-color: #fed136;
}


*,
*::after,
*::before {
    padding: 0;
    margin: 0;
    box-sizing: border-box;
}



.preview {  
    display: block;
    width: 350px;
    height: 350px;
    margin: 50px auto;    
    border: 2px solid lightgray;
    border-radius: 3%;
    overflow: hidden;
}

.file-upload-wrapper {
    position: relative;
    z-index: 5;
    display: block;
    width: 250px;
    height: 30px;
    margin: 50px auto;
    border : 2px solid gray;
}

.file-upload-native,
.file-upload-text {
    position: absolute;
    top: 0;
    left: 0;
    display: block;
    width: 100%;
    height: 100%;
    cursor: pointer;
}
#map {
  width:100%;
  height:400px;
}
input[type="file"]::-webkit-file-upload-button {
    cursor: pointer;
}

.file-upload-native:focus,
.file-upload-text:focus {
    outline: none;
}

.file-upload-text {
    z-index: 10;
    padding: 5px 15px 8px;
    font-size: 14px;
    line-height: 1.4;
    cursor: pointer;
    text-align: center;
    letter-spacing: 1px;
    text-overflow: ellipsis;
    color: rgb(144, 162, 148);
    border: 0;
    background-color: transparent;
}

.file-upload-native {
    z-index: 15;
    opacity: 0;
}

.width-control {
 width: 20%;
}

#loading {
 width: 100%;   
 height: 100%;   
 top: 0px;
 left: 0px;
 position: fixed;   
 display: block;   
 opacity: 0.7;   
 background-color: #fff;   
 z-index: 99;   
 text-align: center; 
}  
 
#loading-image {   
 position: relative;   
 top: 400px;   
 right: auto;   
 z-index: 100px; 
} 

</style>
</head>

<body id="page-top" class="index">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top"  style="background-color: black;">
        <div class="container" >
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a onclick="goMain(event)" class="navbar-brand page-scroll" href="#page-top"><img class='logoimg' src='../img/logos/dlogo.PNG'></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li>
                        <a id='logout' class="login" href="#">로그아웃</a>
                    </li>
                    <li>
                        <a id='resist' class="login grade1" href="#">펫시터등록</a>
                    </li>
                    <li>
                        <a id='deleteresist' class="login grade2" href="#">펫시터삭제</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>



    <!-- Services Section -->
    <div id="inbody">
    <div id="loading">
    <img id="loading-image" src="../img/ajax-loader.gif">
    </div>
    <div id="container1">
    <form id="frm" method="post" name="frm">
    <div class="preview img-wrapper"></div>
	  <div class="file-upload-wrapper">
	      <input type="file" id="uploadFile" name="uploadFile" class="file-upload-native" accept="image/*"/>
	      <input type="text" disabled placeholder="프로필 사진을 등록하세요" class="file-upload-text" />
	  </div>
      <div class="table-responsive table1">
      <div id="deletediv">
      <button id="delete" type="button" class="btn btn-me">회원탈퇴</button>
      </div>
        <table class="table table-bordered">
          <tr class="info">
            <th WIDTH="20%">회원정보</th>
          </tr>
          <tr>
            <td>이름</td>
            <td id="nametd">
              <div class="input-group col-lg-4">
                <input type="text" id="name" name="name" class="form-control" readonly="readonly">
                <span class="input-group-btn">
                  <button id="changeName"  class="btn btn-me" type="button">이름변경</button>
                </span>
              </div>
            </td>
          </tr>
          <tr>
            <td>이메일</td>
            <td id="emailtd">
              <div class="input-group col-lg-4">
                <input type="text" id="email" name="email" class="form-control" readonly="readonly">
                <span class="input-group-btn">
                   <button id="emailrequest"  class="btn btn-me" type="button">인증하기</button>
                </span>
              </div>
            </td>
          </tr>
         <tr>
            <td>연락처</td>
            <td>휴대폰번호
                <select id="agc" name="agc">
                  <option value="SKT">SKT
                  <option value="KT">KT
                  <option value="LG U+">LG U+
                  <option value="알뜰폰">알뜰폰
                </select>
              <div class=" input-group1">
                <input type="text" class="form-control" value="010" id="phone1" name="phone1">
              </div>-
              <div class=" input-group1">
                <input type="text" class="form-control" value="5446" id="phone2" name="phone2">
              </div>-
              <div class=" input-group1">
                <input type="text" class="form-control" value="8470" id="phone3" name="phone3">
              </div>
              <button type="button" class="btn btn-me">인증하기</button>
            </td>
          </tr>
          <tr>
            <td>현재 비밀번호</td>
            <td>
              <div class="input-group col-lg-3">
                <input type="password" id="nowpassword" name="nowpassword" class="form-control" placeholder="바뀌는경우만입력">
              </div>
            </td>
          </tr>
          <tr>
            <td>비밀번호 변경</td>
            <td>
              <div class="input-group col-lg-3">
                <input type="password" id="password" onkeyup="pwdCheck()" name="password" class="form-control" placeholder="바뀌는경우만입력">
              </div>
            </td>
          </tr>
          <tr>
            <td>비밀번호 확인</td>
            <td>
             <div class="input-group col-lg-3">
                <input type="password" id="passwordchk" onkeyup="pwdCheck()" name="passwordchk" class="form-control" placeholder="바뀌는경우만입력" >
                <span id="checkText"></span>
              </div>
              
            </td>
          </tr>
        </table>
      </div>

      <br>
      <div class="grade2">
      <div class="table-responsive">
        <table class="table table-bordered">
          <tr class="info">
            <th WIDTH="20%">펫시터 등록정보</th>
          </tr>
            <tr>
              <td class="th"><span class="thtext">닉네임*</span></td>
              <td class="td"><input type="text" class="form-control width-control" id="nickname">
                <button id="checknick" class="btn btn-me">중복확인</button></td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">1일 가격*</span></td>
              <td class="td"><input type="text" class="form-control width-control"
                id="price">원</td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">카톡 ID*</span></td>
              <td class="td"><input type="text" class="form-control width-control" id="kakao"></td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">활동 지역*</span></td>
              <td class="td"><input type="text" class="form-control width-control" id="region" placeholder="ex) 서울시 강남구"></td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">은행*</span></td>
              <td class="td"><input type="text" class="form-control width-control" id="bank"></td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">예금주*</span></td>
              <td class="td"><input type="text" class="form-control width-control" id="holder"></td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">계좌*</span></td>
              <td class="td"><input type="text" class="form-control width-control" id="account"></td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">추가서비스</span></td>
              <td class="td">
                <label class="checkbox-inline">
                  <input type="checkbox" name="box" id="box1" value="간식 제공">간식 제공 
                </label>
                <label class="checkbox-inline">
                  <input type="checkbox" name="box" id="box2" value="픽업">픽업
                </label>
                <label class="checkbox-inline">
                  <input type="checkbox" name="box" id="box3" value="배변봉투 제공">배변봉투 제공 
                </label>
                <label class="checkbox-inline">
                  <input type="checkbox" name="box"  id="box4" value="목줄/리드줄 보유">  목줄/리드줄 보유
                </label>
                <label class="checkbox-inline">
                  <input type="checkbox" name="box"  id="box5" value="강아지 물통 보유">  강아지 물통 보유
                </label>
              </td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">문의시간*</span></td>
              <td class="td">
                <input type="text" class="form-control width-control" id="inqur1">시 ~ 
                <input type="text" class="form-control width-control" id="inqur2">시</td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">반려동물유무</span></td>
              <td class="td"><input type="number" class="form-control width-control" id="animal"> 마리</td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">인근 동물병원*</span></td>
              <td class="td"><input type="number" class="form-control width-control" id="hospital"> 분 거리</td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">우편번호*</span></td>
              <td class="td"><input type="text" class="form-control width-control" id="addr1"> <button type="button" class="btn btn-me">우편번호검색</button>
              </td>
            </tr>
            <tr>
              <td class="th"><span class="thtext">상세주소*</span></td>
              <td class="td"><input type="text" class="form-control width-control"
                id="addr2"></td>
            </tr>
            <tr>
              <td class="th" colspan="2"><span class="thtext">산책범위 지정하기</span></td>
            </tr>
            <tr>
              <td class="td" colspan="2">
              <div>
                주소 : <input type="text" class="form-control width-control" id="range">
               <button id="addrfind" class="btn btn-me">검색</button>
                <span class="radiandiv">반경 : <input type="text" class="width-control form-control" id="radian" readonly="readonly">M</span>
                <span class="radiandiv"> 마우스 왼쪽(중심좌표),오른쪽(거리조절)</span>
              </div>
              <div id="map"></div></td>
            </tr>
            <tr>
              <td class="th" colspan="2"><span class="thtext">반려동물을 잘 산책할 수 있다는 자기 소개를 적어주세요~ *</span></td>
            </tr>
            <tr>
              <td colspan="2"><textarea id="intro" class="form-control" cols="129" rows="6"></textarea></td>
            </tr>
          </table>
        </div>
      </div>
      <div id="save">
          <button type="submit" id="savebtn" class="btn btn-me">저장</button>
      </div>
      </form>
    </div>
  </div>
  <div id="dialog-confirm" title="회원 탈퇴 확인">
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>정말로 회원 탈퇴하시겠습니까?<br>데이터가 복구되지 않습니다.</p>
  </div>
  <div id="dialog-confirm2" title="회원 정보 변경">
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>회원 정보를 변경하였습니다</p>
  </div>
  <div id="dialog-confirm3" title="회원 정보 변경">
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>회원 정보를 변경하지못했습니다</p>
  </div>
  <div id="dialog-delete" title="펫시터 등록 정보 삭제">
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>등록된 펫시터정보를 삭제하였습니다.</p>
  </div>
  <div id="dialog-deletef" title="펫시터 등록 정보 삭제">
    <p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>등록된 펫시터정보를 삭제 실패했습니다.</p>
  </div>

    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <span class="copyright">Copyright &copy; 산책할개 2016</span>
                </div>
                <div class="col-md-4">
                    <ul class="list-inline social-buttons">
                        <li><a href="#"><i class="fa fa-twitter"></i></a>
                        </li>
                        <li><a href="#"><i class="fa fa-facebook"></i></a>
                        </li>
                        <li><a href="#"><i class="fa fa-linkedin"></i></a>
                        </li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <ul class="list-inline quicklinks">
                        <li><a href="#">Privacy Policy</a>
                        </li>
                        <li><a href="#">Terms of Use</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
<script type="text/javascript">
  $("#delete").click(function() {
    $( "#dialog-confirm" ).dialog({
       resizable: false,
       height:200,
       width:300,
       modal: true,
       buttons: {
         "확인": function() {
           $( this ).dialog( "close" );
           $(function() {
              $.ajax("../ajax/member/delete.do?", {
                  method : "POST",
                  dataType : "json",
              });
           });
           location.href = "../auth/logout.do";
         },
         "취소": function() {
           $( this ).dialog( "close" );
         }
       }
    })
  });
  $("form#frm").submit(function(event){    
	     //disable the default form submission
	     event.preventDefault();
	     var fd = new FormData($(this)[0]);  
	     $.ajax({
	       url: "../ajax/member/upload.do?",
	       type: "POST",
	       data: fd,
	       async: false,
	       cache: false,
	       contentType: false,
	       processData: false,
	       success:  function(result) {
            if (result.status == "success") {
                $(function() {
                    $( "#dialog-confirm2" ).dialog({
                      resizable: false,
                      height:180,
                      width:300,
                      modal: true,
                      buttons: {
                        "확인": function() {
                          $( this ).dialog( "close" );
                        }
                      }
                    });
                  });
                
              } else {
                $(function() {
                   $( "#dialog-confirm3" ).dialog({
                     resizable: false,
                     height:180,
                     width:300,
                     modal: true,
                     buttons: {
                       "확인": function() {
                         $( this ).dialog( "close" );
                       }
                     }
                   });
                 });
              }
            },
            error : function() {
              window.alert("서버요청 실패입니다.");
            }
	     });     
	     return false;     
	});
  
    function goMain(event) {
      location.href = "../main/index.html"
      event.preventDefault();
    }
    function pwdCheck() {
        var upw = $("#password").val();
        var regex_pwd = /^[A-Za-z0-9]{4,10}$/i;
        var chk_num = upw.search(/[0-9]/i); 
        var chk_eng = upw.search(/[A-Za-z]/i);
        if ( regex_pwd.test(upw)) {
           if ( upw != $("#passwordchk").val() ) {
             $("#checkText").html("비밀번호가 일치하지 않습니다.")
             $("#checkText").css("color","red");
           } else {
             if(chk_num < 0 || chk_eng < 0) {
               $("#checkText").html("영문,숫자 혼합 4~10자로 만들어야합니다.")
               $("#checkText").css("color","red");
             } else {
               $("#checkText").html("비밀번호가 일치합니다.")
               $("#checkText").css("color","green");
             }
           }
        } else {
           $("#checkText").html("영문,숫자 혼합 4~10자로 만들어야합니다.")
           $("#checkText").css("color","red");
        } 
      }
    $(document).ready(function() {
   	  $(".grade1").css("display","none");
    	$(".grade2").hide;
      $("#dialog-confirm").css("display","none");
      $("#dialog-confirm2").css("display","none");
      $("#dialog-confirm3").css("display","none");
      $("#dialog-delete").css("display","none");
      $("#dialog-deletef").css("display","none");
      $("#changeName").click(function() {
        if($("#name").attr("readonly")) {
         $("#name").removeAttr("readonly");
        } else {
          $("#name").attr("readonly","readonly");
        }
       });
      $("#resist").click( function() {
        location.href = "../resist/resist.html";
        event.preventDefault();
      });
      $(function() {
          $.ajax("../auth/loging.do?", {
              method : "POST",
              success : function(result) {
                if ( result.status == "failure") {
                  location.href = "../main/index.html";
               }
             }
          });
       })
       $(function() {
          $.getJSON("../ajax/member/detail.do?",
            function(result) {
              $("#agc").val(result.agc).attr("selected","selected");
               if (result.gra == 2) {
                 $(".grade2").css("display","");
                 $(".grade1").css("display","none");
               } else {
                 $(".grade1").css("display","");
                 $(".grade2").css("display","none");
               }
               $("#name").attr("value",result.name);
               $("#email").attr("value",result.email);
               var phoneNum = result.tel.split('-');
               $("#phone1").val(phoneNum[0]);
               $("#phone2").val(phoneNum[1]);
               $("#phone3").val(phoneNum[2]);
               if(result.prof)
               $(".img-wrapper")
               .css('background', 'url(' +"../"+result.prof + ') no-repeat center center')
               .css('background-size', 'cover');
             }
          );
      });
      $("#deleteresist").click( function() {
          $.ajax("../ajax/petsitter/delete.do", {
              method : "POST",
              success : function(result) {
                  if (result.status == "success") {
                      $.post("../ajax/member/upgrade.do?", {gra :  1}, function(result) {}, "json");
                      $(function() {
                          $( "#dialog-delete" ).dialog({
                            resizable: false,
                            height:180,
                            width:300,
                            modal: true,
                            buttons: {
                              "확인": function() {
                                $( this ).dialog( "close" );
                                location.href ="mypage3.html";
                              }
                            }
                          });
                        });
                    } else {
                      $(function() {
                         $( "#dialog-deletef" ).dialog({
                           resizable: false,
                           height:180,
                           width:300,
                           modal: true,
                           buttons: {
                             "확인": function() {
                               $( this ).dialog( "close" );
                             }
                           }
                         });
                       });
                    }
                  },
          });
          event.preventDefault();
      });
      $("#logout").click(function() {
          location.href = "../auth/logout.do";
          event.preventDefault();
        });
      
      $(function() {
    	  function maskImgs() {
    	    //$('.img-wrapper img').imagesLoaded({}, function() {
    	    $.each($('.img-wrapper img'), function(index, img) {
    	      var src = $(img).attr('src');
    	      var parent = $(img).parent();
    	      parent
    	        .css('background', 'url(' + src + ') no-repeat center center')
    	        .css('background-size', 'cover');
    	      $(img).remove();
    	    });
    	    //});
    	  }

    	  var preview = {
    	    init: function() {
    	      preview.setPreviewImg();
    	      preview.listenInput();
    	    },
    	    setPreviewImg: function(fileInput) {
    	      var path = $(fileInput).val();
    	      var uploadText = $(fileInput).siblings('.file-upload-text');

    	      if (!path) {
    	        $(uploadText).val('');
    	      } else {
    	        path = path.replace(/^C:\\fakepath\\/, "");
    	        $(uploadText).val(path);

    	        preview.showPreview(fileInput, path, uploadText);
    	      }
    	    },
    	    showPreview: function(fileInput, path, uploadText) {
    	      var file = $(fileInput)[0].files;

    	      if (file && file[0]) {
    	        var reader = new FileReader();

    	        reader.onload = function(e) {
    	          var previewImg = $(fileInput).parents('.file-upload-wrapper').siblings('.preview');
    	          var img = $(previewImg).find('img');

    	          if (img.length == 0) {
    	             $(previewImg).html('<img src="' + e.target.result + '" alt=""/>');
    	          } else {
    	            img.attr('src', e.target.result);
    	          }
    	          uploadText.val(path);
    	          maskImgs();
    	        }
    	        reader.onloadstart = function() {
    	          $(uploadText).val('uploading..');
    	        }
    	        reader.readAsDataURL(file[0]);
    	      }
    	    },
    	    listenInput: function() {
    	      $('.file-upload-native').on('change', function() {
    	        preview.setPreviewImg(this);
    	      });
    	    }
    	  };
    	  preview.init();
    	});
      var lat;
      var lng;
    //****************************************************************************
    // 다음 지도 API 키 :7ae134637aef8f4bb01892e30a801547
      var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
         mapOption = { 
           center: new daum.maps.LatLng(37.5196784,127.1201637,17), // 지도의 중심좌표
           level: 5 // 지도의 확대 레벨
         };

      // 지도를 표시할 div와  지도 옵션으로  지도를 생성합니다
      var map = new daum.maps.Map(mapContainer, mapOption); 
      var geocoder = new daum.maps.services.Geocoder();
      var zoomControl = new daum.maps.ZoomControl();
      map.addControl(zoomControl, daum.maps.ControlPosition.RIGHT);
      var mapTypeControl = new daum.maps.MapTypeControl();
      map.addControl(mapTypeControl, daum.maps.ControlPosition.TOPRIGHT);
    //****************************************************************************
    
    //****************************************************************************

      var drawingFlag = false; // 원이 그려지고 있는 상태를 가지고 있을 변수입니다
      var centerPosition; // 원의 중심좌표 입니다
      var drawingCircle; // 그려지고 있는 원을 표시할 원 객체입니다
      var drawingLine; // 그려지고 있는 원의 반지름을 표시할 선 객체입니다
      var drawingOverlay; // 그려지고 있는 원의 반경을 표시할 커스텀오버레이 입니다
      var drawingDot; // 그려지고 있는 원의 중심점을 표시할 커스텀오버레이 입니다
    
      var circles = []; // 클릭으로 그려진 원과 반경 정보를 표시하는 선과 커스텀오버레이를 가지고 있을 배열입니다

  // 지도에 클릭 이벤트를 등록합니다
      daum.maps.event.addListener(map, 'click', function(mouseEvent) {
      removeCircles();    
      // 클릭 이벤트가 발생했을 때 원을 그리고 있는 상태가 아니면 중심좌표를 클릭한 지점으로 설정합니다
      if (!drawingFlag) {    
          // 상태를 그리고있는 상태로 변경합니다
          drawingFlag = true; 
          // 원이 그려질 중심좌표를 클릭한 위치로 설정합니다 
          centerPosition = mouseEvent.latLng; 
          // 그려지고 있는 원의 반경을 표시할 선 객체를 생성합니다
          if (!drawingLine) {
            drawingLine = new daum.maps.Polyline({
              strokeWeight: 3, // 선의 두께입니다
              strokeColor: '#00a0e9', // 선의 색깔입니다
              strokeOpacity: 1, // 선의 불투명도입니다 0에서 1 사이값이며 0에 가까울수록 투명합니다
              strokeStyle: 'solid' // 선의 스타일입니다
            });    
          }
          // 그려지고 있는 원을 표시할 원 객체를 생성합니다
          if (!drawingCircle) {                    
            drawingCircle = new daum.maps.Circle({ 
              strokeWeight: 3, // 선의 두께입니다 
              strokeColor: '#75B8FA', // 선의 색깔입니다
              strokeOpacity: 0.5, // 선의 불투명도 입니다 1에서 0 사이의 값이며 0에 가까울수록 투명합니다
              strokeStyle: 'solid', // 선의 스타일 입니다
              fillColor: '#CFE7FF', // 채우기 색깔입니다
              fillOpacity: 0.5  // 채우기 불투명도 입니다 
            });     
          }
          // 그려지고 있는 원의 반경 정보를 표시할 커스텀오버레이를 생성합니다
          if (!drawingOverlay) {
            drawingOverlay = new daum.maps.CustomOverlay({
              xAnchor: 0,
              yAnchor: 0,
              zIndex: 1
            });              
          }
      }
      });

  // 지도에 마우스무브 이벤트를 등록합니다
  // 원을 그리고있는 상태에서 마우스무브 이벤트가 발생하면 그려질 원의 위치와 반경정보를 동적으로 보여주도록 합니다
  daum.maps.event.addListener(map, 'mousemove', function (mouseEvent) {
      // 마우스무브 이벤트가 발생했을 때 원을 그리고있는 상태이면
      if (drawingFlag) {
          // 마우스 커서의 현재 위치를 얻어옵니다 
          var mousePosition = mouseEvent.latLng; 
          // 그려지고 있는 선을 표시할 좌표 배열입니다. 클릭한 중심좌표와 마우스커서의 위치로 설정합니다
          var linePath = [centerPosition, mousePosition];     
          // 그려지고 있는 선을 표시할 선 객체에 좌표 배열을 설정합니다
          drawingLine.setPath(linePath);
          // 원의 반지름을 선 객체를 이용해서 얻어옵니다 
          var length = drawingLine.getLength();
          if(length > 0) {
              // 그려지고 있는 원의 중심좌표와 반지름입니다
              var circleOptions = { 
                  center : centerPosition, 
                  radius: length,                 
              };
              // 그려지고 있는 원의 옵션을 설정합니다
              drawingCircle.setOptions(circleOptions); 
              // 반경 정보를 표시할 커스텀오버레이의 내용입니다
              var radius = Math.round(drawingCircle.getRadius()),   
              content = '<div class="info">반경 <span class="number">' + radius + '</span>m</div>';
              // 반경 정보를 표시할 커스텀 오버레이의 좌표를 마우스커서 위치로 설정합니다
              drawingOverlay.setPosition(mousePosition);
              // 반경 정보를 표시할 커스텀 오버레이의 표시할 내용을 설정합니다
              drawingOverlay.setContent(content);
              // 그려지고 있는 원을 지도에 표시합니다
              drawingCircle.setMap(map); 
              // 그려지고 있는 선을 지도에 표시합니다
              drawingLine.setMap(map);  
              // 그려지고 있는 원의 반경정보 커스텀 오버레이를 지도에 표시합니다
              drawingOverlay.setMap(map);
          } else { 
              drawingCircle.setMap(null);
              drawingLine.setMap(null);    
              drawingOverlay.setMap(null);
          }
         }     
      });     

  // 지도에 마우스 오른쪽 클릭이벤트를 등록합니다
  // 원을 그리고있는 상태에서 마우스 오른쪽 클릭 이벤트가 발생하면
  // 마우스 오른쪽 클릭한 위치를 기준으로 원과 원의 반경정보를 표시하는 선과 커스텀 오버레이를 표시하고 그리기를 종료합니다
      daum.maps.event.addListener(map, 'rightclick', function (mouseEvent) {

      if (drawingFlag) {
          // 마우스로 오른쪽 클릭한 위치입니다 
          var rClickPosition = mouseEvent.latLng; 
          // 원의 반경을 표시할 선 객체를 생성합니다
          var polyline = new daum.maps.Polyline({
              path: [centerPosition, rClickPosition], // 선을 구성하는 좌표 배열입니다. 원의 중심좌표와 클릭한 위치로 설정합니다
              strokeWeight: 3, // 선의 두께 입니다
              strokeColor: '#00a0e9', // 선의 색깔입니다
              strokeOpacity: 1, // 선의 불투명도입니다 0에서 1 사이값이며 0에 가까울수록 투명합니다
              strokeStyle: 'solid' // 선의 스타일입니다
          });
          // 원 객체를 생성합니다
          var circle = new daum.maps.Circle({ 
              center : centerPosition, // 원의 중심좌표입니다
              radius: polyline.getLength(), // 원의 반지름입니다 m 단위 이며 선 객체를 이용해서 얻어옵니다
              strokeWeight: 3, // 선의 두께입니다 
              strokeColor: '#75B8FA', // 선의 색깔입니다
              strokeOpacity: 0.5, // 선의 불투명도 입니다 1에서 0 사이의 값이며 0에 가까울수록 투명합니다
              strokeStyle: 'solid', // 선의 스타일 입니다
              fillColor: '#CFE7FF', // 채우기 색깔입니다
              fillOpacity: 0.5  // 채우기 불투명도 입니다  
          });
          var radius = Math.round(circle.getRadius()) // 원의 반경 정보를 얻어옵니다
              content = getTimeHTML(radius); // 커스텀 오버레이에 표시할 반경 정보입니다
          // 반경정보를 표시할 커스텀 오버레이를 생성합니다
          var radiusOverlay = new daum.maps.CustomOverlay({
              content: content, // 표시할 내용입니다
              position: rClickPosition, // 표시할 위치입니다. 클릭한 위치로 설정합니다
              xAnchor: 0,
              yAnchor: 0,
              zIndex: 1 
          });  
          // 원을 지도에 표시합니다
          circle.setMap(map); 
          // 선을 지도에 표시합니다
          polyline.setMap(map);
          // 반경 정보 커스텀 오버레이를 지도에 표시합니다
          radiusOverlay.setMap(map);
          // 배열에 담을 객체입니다. 원, 선, 커스텀오버레이 객체를 가지고 있습니다
          var radiusObj = {
              'polyline' : polyline,
              'circle' : circle,
              'overlay' : radiusOverlay
          };
          // 배열에 추가합니다
          // 이 배열을 이용해서 "모두 지우기" 버튼을 클릭했을 때 지도에 그려진 원, 선, 커스텀오버레이들을 지웁니다
          circles.push(radiusObj);   
          // 그리기 상태를 그리고 있지 않는 상태로 바꿉니다
          drawingFlag = false;
          lat = centerPosition.bb;
          lng = centerPosition.ab;
          // 중심 좌표를 초기화 합니다  
          centerPosition = null;
          
          // 그려지고 있는 원, 선, 커스텀오버레이를 지도에서 제거합니다
          drawingCircle.setMap(null);
          drawingLine.setMap(null);   
          drawingOverlay.setMap(null);
      }
  });    
      
  // 지도에 표시되어 있는 모든 원과 반경정보를 표시하는 선, 커스텀 오버레이를 지도에서 제거합니다
  function removeCircles() {         
      for (var i = 0; i < circles.length; i++) {
          circles[i].circle.setMap(null);    
          circles[i].polyline.setMap(null);
          circles[i].overlay.setMap(null);
      }         
      circles = [];
  }


  //마우스 우클릭 하여 원 그리기가 종료됐을 때 호출하여 
  //그려진 원의 반경 정보와 반경에 대한 도보, 자전거 시간을 계산하여
  //HTML Content를 만들어 리턴하는 함수입니다
  function getTimeHTML(distance) {

   // 도보의 시속은 평균 4km/h 이고 도보의 분속은 67m/min입니다
   /* var walkkTime = distance / 67 | 0;
   var walkHour = '', walkMin = '';

   // 계산한 도보 시간이 60분 보다 크면 시간으로 표시합니다
   if (walkkTime > 60) {
       walkHour = '<span class="number">' + Math.floor(walkkTime / 60) + '</span>시간 '
   }
   walkMin = '<span class="number">' + walkkTime % 60 + '</span>분'
    */
   // 거리와 도보 시간, 자전거 시간을 가지고 HTML Content를 만들어 리턴합니다
   var content = '<ul class="info">';
   content += '    <li>';
   content += '        <span class="label">총거리</span><span class="number">' + distance + '</span>m';
   content += '    </li>';
   //content += '    <li>';
   //content += '        <span class="label">도보</span>' + walkHour + walkMin;
   //content += '    </li>';
   content += '</ul>'
   $("#radian").val(distance);
   return content;
  }

     $("#addrfind").click(function() {
       geocoder.addr2coord($("#range").val(), function(status, result) {

          // 정상적으로 검색이 완료됐으면 
           if (status === daum.maps.services.Status.OK) {

              var coords = new daum.maps.LatLng(result.addr[0].lat, result.addr[0].lng);

              // 결과값으로 받은 위치를 마커로 표시합니다
              var marker = new daum.maps.Marker({
                  map: map,
                  position: coords
              });

              // 인포윈도우로 장소에 대한 설명을 표시합니다
              var infowindow = new daum.maps.InfoWindow({
                  content: '<div style="width:150px;text-align:center;padding:6px 0";>위치</div>'
              });
              infowindow.open(map, marker);

              // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
              map.setCenter(coords);
          } 
      }); 
     })
    });
    
    $(window).load(function() {     
        $('#loading').hide();   
      }); 
  </script>
</body>
</html>
